Commit 18: Code cleanup and refactoring
