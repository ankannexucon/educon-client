Commit 20: Final optimizations
